# 签名问题最终解决方案

## 问题总结

签名文件和密码配置始终不匹配，导致构建失败。

## 推荐方案：让 DevEco Studio 重新生成配置

### 步骤：

1. **删除当前的签名配置**
   
   在服务器上，删除 `c:\huawei\.signing` 目录的所有内容

2. **清空 build-profile.json5 中的签名配置**
   
   将 `signingConfigs` 改为空数组：
   ```json5
   "signingConfigs": [],
   ```

3. **在 DevEco Studio 中重新配置**
   
   a. File → Project Structure → Signing Configs
   
   b. 手动选择本地的签名文件：
      - Store File: 浏览到本地的 `.p12` 文件
      - Profile: 浏览到本地的 `.p7b` 文件  
      - Certpath: 浏览到本地的 `.cer` 文件
   
   c. **不要填写密码！**
      - 让密码字段保持空白
      - 点击 Apply
      - DevEco Studio 会尝试读取文件
      - 如果提示输入密码，点击"取消"
   
   d. 如果 DevEco Studio 要求输入密码：
      - 这说明签名文件有密码保护
      - 但我们不知道自动生成的密码是什么
      - **所以这个方法行不通**

## 替代方案 1：在本地构建，传 HAP 到服务器

既然签名问题这么复杂，最简单的方法是：

1. **在本地电脑（能正常签名的地方）构建 HAP**
   ```
   Build → Build Hap(s)
   ```

2. **找到生成的 HAP 文件**
   ```
   entry\build\default\outputs\default\entry-default-signed.hap
   ```

3. **直接将 HAP 文件传输到服务器**
   - 使用 FTP、SCP 或其他方式
   - HAP 文件已经签名完成，可以直接使用

4. **在服务器上部署测试**
   - 不需要在服务器上构建
   - 直接使用传输过来的 HAP 文件

### 优点：
- ✅ 简单可靠
- ✅ 避开签名问题
- ✅ 立即可用

## 替代方案 2：使用未签名的 HAP（仅测试）

如果只是为了测试功能：

1. **构建未签名的 HAP**
   - 清空 build-profile.json5 的 signingConfigs
   - 构建会生成 `entry-default-unsigned.hap`

2. **手动签名（使用命令行工具）**
   - 需要 HarmonyOS SDK 的签名工具
   - 比较复杂，不推荐

## 替代方案 3：重新生成全新的签名

从头开始：

1. 删除所有旧的签名文件和配置

2. 在服务器上，从华为 AGC 平台重新下载签名文件：
   - 访问 AppGallery Connect
   - 删除旧的调试证书
   - 生成新的调试证书（设置简单密码如 123456）
   - 下载新的文件到服务器

3. 在 DevEco Studio 中配置新的签名

## 推荐做法

**最快的解决方案：**

在本地电脑构建 → 传 HAP 到服务器 → 直接测试

**原因：**
- DevEco Studio 自动生成的签名密码无法获知
- 文件和密码的匹配关系很难手动维护
- 已签名的 HAP 文件可以直接使用，不需要重新签名
