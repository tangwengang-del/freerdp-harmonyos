# 获取 HarmonyOS 签名文件详细步骤

## 方法一：从华为开发者平台获取（推荐）

### 前提条件
- 华为开发者账号（如没有需要先注册）
- 浏览器访问权限

### 步骤 1：注册/登录华为开发者账号

1. 访问：https://developer.huawei.com/
2. 点击右上角"登录/注册"
3. 使用华为账号登录（如没有，先注册）

### 步骤 2：实名认证（如未认证）

1. 登录后，进入"个人中心"
2. 完成实名认证（需要身份证信息）
3. 等待审核通过（通常几分钟到几小时）

### 步骤 3：进入 AppGallery Connect

1. 访问：https://developer.huawei.com/consumer/cn/service/josp/agc/index.html
2. 或从开发者中心点击"AppGallery Connect"

### 步骤 4：创建项目

1. 点击"我的项目"
2. 点击"新建项目"或"创建项目"
3. 输入项目名称（例如：FreeRDP-HarmonyOS）
4. 点击"确定"

### 步骤 5：添加应用

1. 在项目中点击"添加应用"
2. 选择"HarmonyOS"平台
3. 输入应用信息：
   - **应用名称**：FreeRDP Remote Desktop（或您喜欢的名称）
   - **包名**：`com.example.myapplication`（必须与项目中的 bundleName 一致）
   - **应用分类**：选择"工具"或"效率"
4. 点击"确定"

**重要**：包名必须与 `AppScope/app.json5` 中的 `bundleName` 一致！

### 步骤 6：生成签名证书

1. 在应用管理页面，点击左侧菜单"证书"或"Signing Configs"
2. 选择"调试证书"或"Debug Certificate"
3. 点击"生成证书"或"Generate"

#### 6.1 生成密钥库（Keystore）

如果需要先创建密钥库：
- 输入别名（Key Alias）：可以使用 `debugKey`
- 设置密码（建议使用简单密码，如：`123456`）
- 点击"生成"

#### 6.2 生成证书（Certificate）

- 选择证书类型：调试证书（Debug）
- 有效期：自动设置（通常1年）
- 点击"生成证书"

#### 6.3 生成 Provision Profile

- 选择应用包名
- 选择证书
- 设置设备列表（调试用，可以选择"all"或添加测试设备）
- 点击"生成"

### 步骤 7：下载签名文件

生成完成后，下载以下三个文件：

1. **debug.p12** - 密钥库文件
   - 文件名可能是：`xxx.p12` 或 `keystore.p12`
   - 包含私钥信息

2. **debug.cer** - 证书文件
   - 文件名可能是：`xxx.cer` 或 `certificate.cer`
   - 包含公钥信息

3. **debug.p7b** - Provision Profile
   - 文件名可能是：`xxx.p7b` 或 `profile.p7b`
   - 包含应用签名配置

### 步骤 8：重命名并放置文件

1. 将下载的文件重命名为：
   ```
   debug.p12
   debug.cer
   debug.p7b
   ```

2. 将这三个文件放到项目目录：
   ```
   c:\huawei\.signing\
   ```

3. 最终目录结构：
   ```
   c:\huawei\.signing\
   ├── debug.p12
   ├── debug.cer
   ├── debug.p7b
   └── README.md
   ```

### 步骤 9：记录密码信息

**重要**：记住您设置的密码！

创建一个安全的地方记录：
- Store Password（密钥库密码）：______
- Key Alias（密钥别名）：debugKey
- Key Password（密钥密码）：______（通常与 Store Password 相同）

**注意**：不要将密码保存在 Git 仓库中！

---

## 方法二：使用 DevEco Studio 生成（需要 GUI 环境）

如果您有其他机器可以运行 DevEco Studio：

### 步骤 1：安装 DevEco Studio

1. 下载：https://developer.huawei.com/consumer/cn/deveco-studio/
2. 安装到 Windows/macOS/Linux

### 步骤 2：打开项目

1. 启动 DevEco Studio
2. 打开本项目：`c:\huawei`

### 步骤 3：配置签名

1. 菜单栏：**File** → **Project Structure**
2. 左侧选择：**Project** → **Signing Configs**
3. 在右侧面板：
   - 勾选：**"Automatically generate signature"**
   - 选择 Team（如果有）
   - 等待自动生成

### 步骤 4：查找生成的文件

自动生成后，文件位于：
```
c:\huawei\.signing\
或
%USERPROFILE%\.ohos\config\auto_debug_*\
```

### 步骤 5：复制到项目

将生成的三个文件复制到：
```
c:\huawei\.signing\
```

---

## 常见问题

### Q1：找不到"证书"或"Signing Configs"菜单？

**A**：可能是因为：
- 应用刚创建，页面未刷新 → 刷新浏览器
- 权限不足 → 确认已完成实名认证
- 界面版本差异 → 查找类似的"签名"、"证书"、"配置"等菜单

### Q2：生成证书时提示"设备未绑定"？

**A**：
- 调试证书可以选择"所有设备"
- 或暂时跳过，先生成证书和密钥库
- 后续可以在设备管理中添加设备

### Q3：下载的文件名不是 debug.p12/cer/p7b？

**A**：
- 直接重命名为 `debug.p12`, `debug.cer`, `debug.p7b`
- 只要是同一套签名文件即可

### Q4：忘记设置的密码怎么办？

**A**：
- 重新生成新的签名文件
- 华为平台可以删除旧证书，生成新的

### Q5：包名（bundleName）在哪里查看？

**A**：
查看文件：`c:\huawei\AppScope\app.json5`

```json5
{
  "app": {
    "bundleName": "com.example.myapplication",  // 这就是包名
    ...
  }
}
```

### Q6：是否需要付费？

**A**：
- 调试证书：**免费**
- 发布证书：注册开发者账号后免费
- 上架应用：需要开发者认证（可能需要付费）

---

## 验证签名文件

获取文件后，运行验证脚本：

```powershell
.\setup-signing.ps1
```

应该看到：
```
[OK] Found P12 file: debug.p12
[OK] Found CER file: debug.cer
[OK] Found P7B file: debug.p7b
Signing configuration complete!
```

---

## 下一步

签名文件配置完成后：

1. 验证配置：`.\setup-signing.ps1`
2. 构建应用：`.\build-and-sign.ps1`
3. 找到 HAP：`entry\build\default\outputs\default\entry-default-signed.hap`
4. 上传测试

---

## 额外资源

- 📚 [HarmonyOS 签名指南](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-signing-V5)
- 🌐 [AppGallery Connect 帮助](https://developer.huawei.com/consumer/cn/doc/development/AppGallery-connect-Guides/agc-introduction-0000001053628980)
- 💬 [华为开发者论坛](https://developer.huawei.com/consumer/cn/forum/)

---

**祝您获取签名文件顺利！如有问题，随时查阅本文档。**
